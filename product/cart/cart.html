<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>知行筆記 - 購物車</title>
    <link rel="stylesheet" href="cartstyle.css">
    <link rel="stylesheet" href="../allstyle.css"> 
</head>
<body>
    <header>
        <section class="size">
            <div class="logo">
                <a href="../../index.html" class="logo-link">知行筆記</a>
            </div>
        </section>
        
        <nav class="top-nav">
            <form action="../search/search-results.html" method="GET"> 
                <input type="text" name="q" placeholder="請輸入想搜尋的產品" class="search-input">
                <button type="submit" class="search-button">開始搜尋</button>
            </form>
            
            <div class="category-dropdown">
                
                <input type="checkbox" id="category-toggle" class="category-toggle" hidden>
                
                <label for="category-toggle" class="category-link">商品類別</label>
                
                <ul class="dropdown-content">
                    <li><a href="../category/category.html?type=pen">🖋️ 精準書寫</a></li> 
                    <li><a href="../category/category.html?type=book">📓 筆記介面</a></li>
                    <li><a href="../category/category.html?type=desk">💻 桌面環境</a></li>
                </ul>
            </div>
            <a href="../login/login.html" class="member-link">會員登入</a>
            <a href="cart.html" class="shopping-cart-link">購物車</a>
        </nav>
    </header>

    <div class="container">
        <h1 class="containera">🛒 我的購物車</h1>
        
        <table class="cart-table">
            <thead>
                <tr>
                    <th>商品名稱</th>
                    <th>單價</th>
                    <th>數量</th>
                    <th>小計</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody id="cart-items">
                </tbody>
        </table>

        <div class="info-section" id="shipping-details-section">
            <h2>🚚 運送/收件人資訊</h2>

            <div class="form-group">
                <label for="shipping-method">請選擇運送方式:</label>
                <select id="shipping-method" style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 1em;">
                    <option value="home-delivery">📦 宅配到府 (運費 $59)</option>
                    <option value="convenience-store">🏪 超商取貨 (運費 $39)</option> 
                </select>
            </div>
            
            <p id="shipping-fee-display" style="font-weight: bold; color: #007bff; margin-top: 10px;">運費：$0</p>

            <div id="recipient-details">
                <div class="input-group">
                    <label for="recipient-name">收件人姓名:</label>
                    <input type="text" id="recipient-name" placeholder="請填寫收件人姓名" required>
                </div>

                <div class="input-group">
                    <label for="recipient-phone">連絡電話:</label>
                    <input type="tel" id="recipient-phone" placeholder="請填寫手機號碼" required>
                </div>

                <div class="input-group" id="address-group">
                    <label for="recipient-address">收件地址:</label>
                    <input type="text" id="recipient-address" placeholder="請填寫完整地址" required>
                </div>
                
                <div id="store-pickup-info" style="display: none; padding: 10px; border: 1px dashed #ccc; margin-top: 15px; background-color: #fffbe6; color: #8a6d3b; border-radius: 4px;">
                    *超商取貨: 請確認收件人姓名與電話正確，門市地址將在結帳後提供選擇。
                </div>
            </div>
        </div>
        
        <div class="info-section" id="payment-info">
            <h2>💳 付款方式</h2>
            <select id="payment-method" style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 1em;">
                <option value="bank-transfer">銀行/ATM 轉帳</option> 
                <option value="cash-on-delivery">貨到付款 / 超商取貨付款</option> 
            </select>
            <div id="payment-details" style="margin-top: 15px; padding: 10px; border: 1px solid #eee; background-color: #fcfcfc;">
                </div>
        </div>
        
        <div class="info-section">
            <h2>💬 訂單備註 <button id="toggle-note-btn" style="padding: 5px 10px; font-size: 0.8em;">新增備註</button></h2>
            <div id="note-section" style="display: none; margin-top: 10px;">
                <textarea id="order-note" placeholder="請填寫您想告知賣家的事項（例如：指定送貨日期等），最多 200 字。" maxlength="200" style="width: 100%; height: 80px; padding: 10px; box-sizing: border-box;"></textarea>
            </div>
        </div>

        <div class="total" id="cart-total">
            總金額：$0
        </div>

        <div class="checkout-button-container">
            <button id="checkout-btn">
                結帳購買
            </button>
        </div>

        <div class="info-section" id="shipping-info">
            <h2>🚚 配送資訊</h2>
            <ul>  
                <li>配送時程: 現貨商品將在 1~3 個工作天內寄出，包裹預計 4~7 個工作天到達，預購商品依頁面標示時程為準。</li>
                <li>運費說明: 訂單金額滿 $ 499 享免運費；未滿 $ 499 則收取運費。</li>
                <li>配送方式: 提供宅配到府、超商取貨等運送服務。</li>
            </ul>
        </div>

        <div class="info-section" id="sales-rules">
            <h2>📄 商品銷售規則</h2>
            <ul>
                <li>退換貨: 依消費者保護法，享有七天鑑賞期（非試用期）。商品須保持全新狀態。</li>
                <li>訂單取消: 訂單成立後 4 小時內可自行取消，超過時間請聯繫客服處理。</li>
                <li>發票: 本店提供電子發票，將於出貨後寄送至您的電子信箱。</li>
            </ul>
        </div>

        <div class="info-section" id="contact-info">
            <h2>📞 聯絡資料</h2>
            <p>如果您有任何疑問，歡迎透過以下方式與我們聯繫：</p>
            <ul>
                <li>客服信箱: <a href="mailto:note123@gmail.com">note123@gmail.com</a></li>
                <li>客服電話: (02) 1234-5678 (服務時間: 平日 09:00 - 18:00)</li>
            </ul>
        </div>

        <footer class="main-footer">
            <div class="footer-content-wrapper">
                <div class="footer-column">
                    <h4>聯絡我們</h4>
                    <ul>
                      <li>客服信箱: <a href="mailto:note123@gmail.com">note123@gmail.com</a></li>
                      <li>服務時間: Mon-Fri 09:00 - 18:00</li>
                      <li><a href="../../faq/faq.html">常見問題 (FAQ)</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h4>商品分類</h4>
                    <ul>
                        <li><a href="../category/category.html?type=pen">精準書寫</a></li>
                        <li><a href="../category/category.html?type=book">筆記介面</a></li>
                        <li><a href="../category/category.html?type=desk">桌面環境</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h4>會員服務</h4>
                    <ul>
                        <li><a href="../login/login.html">會員登入</a></li>
                        <li><a href="../cart/cart.html">購物車</a></li>
                        <li><a href="../../about/about.html">關於我們</a></li>
                    </ul>
                </div>
            </div>
            <div class="main-footer">
                <a href="../../index.html" class="footer-home-link">返回首頁</a>
            </div>
            <div class="footer-bottom">
                <p>© 2025 知行筆記 版權所有.</p>
            </div>
        </footer>

        <script src="cart.js"></script>
        <script src="../login/header-status.js"></script>

        <script>
            document.getElementById("checkout-btn").addEventListener("click", function () {
                const isLoggedIn = localStorage.getItem("isLoggedIn") === "true";
                if (!isLoggedIn) {
                    const currentUrl = window.location.pathname;
                    window.location.href = "../login/login.html?returnUrl=" + encodeURIComponent(currentUrl);
                    return;
                }
                alert("已登入，可進行結帳流程");
            });
            </script>
</body> 
</html>